openapi: 3.0.3
info:
  title: YatraX Admin API
  description: |
    RESTful API for YatraX admin panel. All endpoints require admin authentication except the login endpoint.
    
    ## Authentication
    The API uses JWT token-based authentication.
    - Tokens expire in 7 days (default)
    - Include token in Authorization header: `Bearer <token>`
    - All endpoints (except `/auth/login`) require admin role
    
    ## Admin Access
    - Only users with `role: "admin"` can access these endpoints
    - Admin can be from either User model or Guide model
    - Login endpoint accepts `userType` parameter to specify which model to check
  version: 1.0.0
  contact:
    name: YatraX API Support
    email: support@yatrax.com

servers:
  - url: http://localhost:8000/api/admin
    description: Development server
  - url: https://api.yatrax.com/api/admin
    description: Production server

tags:
  - name: Admin Authentication
    description: Admin login and profile management
  - name: User Management
    description: CRUD operations for user accounts
  - name: Guide Management
    description: CRUD operations for guide accounts
  - name: Guide Availability
    description: Get and set guide availability by date range (admin only)
  - name: Trail Management
    description: CRUD operations for trail GeoJSON data
  - name: Trail Info Management
    description: CRUD operations for trail information and metadata
  - name: Statistics
    description: Dashboard statistics and analytics

paths:
  /auth/login:
    post:
      tags:
        - Admin Authentication
      summary: Admin login
      description: |
        Authenticate admin with email and password. Admin can be from User model or Guide model.
        If `userType` is not provided, the backend checks User model first, then Guide model.
      operationId: loginAdmin
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  maxLength: 255
                  example: "admin@yatrax.com"
                  description: Admin email address
                password:
                  type: string
                  format: password
                  minLength: 8
                  maxLength: 128
                  example: "admin123"
                  description: Admin password
                userType:
                  type: string
                  enum: ["user", "guide"]
                  example: "user"
                  description: Optional. If not provided, backend checks User first then Guide.
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Admin login successful"
                  token:
                    type: string
                    example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                    description: JWT access token
                  admin:
                    $ref: '#/components/schemas/AdminProfile'
        '400':
          description: Invalid credentials or validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/profile:
    get:
      tags:
        - Admin Authentication
      summary: Get admin profile
      description: Get the authenticated admin's profile information
      operationId: getAdminProfile
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Profile retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  admin:
                    $ref: '#/components/schemas/AdminProfile'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Not an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Admin not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /users:
    get:
      tags:
        - User Management
      summary: Get all users
      description: Retrieve a list of all users in the system
      operationId: getAllUsers
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Users retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  count:
                    type: integer
                    example: 150
                  users:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags:
        - User Management
      summary: Create a new user
      description: Create a new user account (admin only)
      operationId: createUser
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - firstName
                - lastName
                - email
                - password
              properties:
                firstName:
                  type: string
                  minLength: 1
                  maxLength: 50
                  example: "John"
                lastName:
                  type: string
                  minLength: 1
                  maxLength: 50
                  example: "Doe"
                email:
                  type: string
                  format: email
                  maxLength: 255
                  example: "user@example.com"
                password:
                  type: string
                  format: password
                  minLength: 8
                  maxLength: 128
                  example: "password123"
                country:
                  type: string
                  maxLength: 100
                  example: "Nepal"
                role:
                  type: string
                  enum: ["user", "porter", "admin"]
                  default: "user"
                  example: "user"
                subscription:
                  type: string
                  enum: ["free", "premium"]
                  default: "free"
                  example: "free"
      responses:
        '201':
          description: User created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "User created successfully"
                  token:
                    type: string
                    example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                    description: JWT token for the created user
                  user:
                    $ref: '#/components/schemas/UserBasic'
        '400':
          description: Validation error or email already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /users/{id}:
    get:
      tags:
        - User Management
      summary: Get user by ID
      description: Retrieve a specific user by their ID
      operationId: getUserById
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
          example: "507f1f77bcf86cd799439011"
          description: MongoDB ObjectId of the user
      responses:
        '200':
          description: User retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  user:
                    $ref: '#/components/schemas/User'
        '400':
          description: Invalid user ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - User Management
      summary: Update user
      description: Update an existing user's information
      operationId: updateUser
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
          example: "507f1f77bcf86cd799439011"
          description: MongoDB ObjectId of the user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                firstName:
                  type: string
                  minLength: 1
                  maxLength: 50
                  example: "John"
                lastName:
                  type: string
                  minLength: 1
                  maxLength: 50
                  example: "Doe"
                email:
                  type: string
                  format: email
                  maxLength: 255
                  example: "user@example.com"
                country:
                  type: string
                  maxLength: 100
                  example: "Nepal"
                role:
                  type: string
                  enum: ["user", "porter", "admin"]
                  example: "user"
                subscription:
                  type: string
                  enum: ["free", "premium"]
                  example: "premium"
      responses:
        '200':
          description: User updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "User updated successfully"
                  user:
                    $ref: '#/components/schemas/User'
        '400':
          description: Validation error or email already in use
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - User Management
      summary: Delete user
      description: Delete a user account. Cannot delete your own admin account.
      operationId: deleteUser
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
          example: "507f1f77bcf86cd799439011"
          description: MongoDB ObjectId of the user
      responses:
        '200':
          description: User deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "User deleted successfully"
        '400':
          description: Cannot delete your own admin account or invalid ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /guides:
    get:
      tags:
        - Guide Management
      summary: Get all guides
      description: Retrieve a list of all guides in the system
      operationId: getAllGuides
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Guides retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  count:
                    type: integer
                    example: 50
                  guides:
                    type: array
                    items:
                      $ref: '#/components/schemas/Guide'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags:
        - Guide Management
      summary: Create a new guide
      description: Create a new guide account (admin only)
      operationId: createGuide
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - firstName
                - lastName
                - email
                - password
                - description
                - TBNumber
                - trekAreas
                - experience
                - education
                - languages
                - ratePerDay
                - certifications
              properties:
                firstName:
                  type: string
                  minLength: 1
                  maxLength: 50
                  example: "Ram"
                lastName:
                  type: string
                  minLength: 1
                  maxLength: 50
                  example: "Shrestha"
                email:
                  type: string
                  format: email
                  maxLength: 255
                  example: "guide@example.com"
                password:
                  type: string
                  format: password
                  minLength: 8
                  maxLength: 128
                  example: "password123"
                description:
                  type: string
                  minLength: 1
                  example: "Experienced trekking guide with 10 years of experience"
                TBNumber:
                  type: string
                  minLength: 1
                  example: "TB-12345"
                  description: Trekking Board Number (unique)
                trekAreas:
                  type: array
                  minItems: 1
                  items:
                    type: string
                  example: ["Everest Base Camp", "Annapurna Circuit", "Langtang"]
                experience:
                  type: integer
                  minimum: 0
                  example: 10
                  description: Years of experience
                education:
                  type: string
                  minLength: 1
                  example: "Bachelor's in Tourism"
                languages:
                  type: array
                  minItems: 1
                  items:
                    type: string
                  example: ["English", "Nepali", "Hindi"]
                ratePerDay:
                  type: number
                  minimum: 0
                  example: 50
                  description: Rate per day in USD
                certifications:
                  type: array
                  minItems: 1
                  items:
                    type: string
                  example: ["Wilderness First Aid", "Mountain Guide Certification"]
                role:
                  type: string
                  enum: ["guide", "admin"]
                  default: "guide"
                  example: "guide"
      responses:
        '201':
          description: Guide created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Guide created successfully"
                  guide:
                    $ref: '#/components/schemas/GuideBasic'
        '400':
          description: Validation error, email already exists, or TBNumber already in use
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /guides/{id}:
    get:
      tags:
        - Guide Management
      summary: Get guide by ID
      description: Retrieve a specific guide by their ID
      operationId: getGuideById
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
          example: "507f1f77bcf86cd799439011"
          description: MongoDB ObjectId of the guide
      responses:
        '200':
          description: Guide retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  guide:
                    $ref: '#/components/schemas/Guide'
        '400':
          description: Invalid guide ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Guide not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Guide Management
      summary: Update guide
      description: Update an existing guide's information
      operationId: updateGuide
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
          example: "507f1f77bcf86cd799439011"
          description: MongoDB ObjectId of the guide
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                firstName:
                  type: string
                  minLength: 1
                  maxLength: 50
                  example: "Ram"
                lastName:
                  type: string
                  minLength: 1
                  maxLength: 50
                  example: "Shrestha"
                email:
                  type: string
                  format: email
                  maxLength: 255
                  example: "guide@example.com"
                description:
                  type: string
                  example: "Experienced trekking guide"
                TBNumber:
                  type: string
                  example: "TB-12345"
                trekAreas:
                  type: array
                  items:
                    type: string
                  example: ["Everest Base Camp", "Annapurna Circuit"]
                experience:
                  type: integer
                  minimum: 0
                  example: 10
                education:
                  type: string
                  example: "Bachelor's in Tourism"
                languages:
                  type: array
                  items:
                    type: string
                  example: ["English", "Nepali"]
                ratePerDay:
                  type: number
                  minimum: 0
                  example: 50
                certifications:
                  type: array
                  items:
                    type: string
                  example: ["Wilderness First Aid"]
                role:
                  type: string
                  enum: ["guide", "admin"]
                  example: "guide"
      responses:
        '200':
          description: Guide updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Guide updated successfully"
                  guide:
                    $ref: '#/components/schemas/Guide'
        '400':
          description: Validation error or email already in use
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Guide not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Guide Management
      summary: Delete guide
      description: Delete a guide account. Cannot delete your own admin account.
      operationId: deleteGuide
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
          example: "507f1f77bcf86cd799439011"
          description: MongoDB ObjectId of the guide
      responses:
        '200':
          description: Guide deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Guide deleted successfully"
        '400':
          description: Cannot delete your own admin account or invalid ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Guide not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /guides/{id}/availability:
    get:
      tags:
        - Guide Availability
      summary: Get guide availability
      description: Get guide availability calendar for a date range. Admin only. Requires authentication.
      operationId: getGuideAvailability
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
          description: Guide ID (MongoDB ObjectId)
        - name: from
          in: query
          required: true
          schema:
            type: string
            format: date
            example: "2025-01-01"
          description: Start date (YYYY-MM-DD)
        - name: to
          in: query
          required: true
          schema:
            type: string
            format: date
            example: "2025-01-31"
          description: End date (YYYY-MM-DD)
      responses:
        '200':
          description: Availability calendar retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  guideId:
                    type: string
                  from:
                    type: string
                    example: "2025-01-01"
                  to:
                    type: string
                    example: "2025-01-31"
                  calendar:
                    type: array
                    items:
                      type: object
                      properties:
                        date:
                          type: string
                        status:
                          type: string
                          enum: [available, "not available"]
        '400':
          description: Invalid guide ID or date parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Guide not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Guide Availability
      summary: Set guide availability
      description: Set any guide's availability. Admin only. One document per date range (single date, startDate/endDate, or dates array).
      operationId: setGuideAvailability
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
          description: Guide ID (MongoDB ObjectId)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                date:
                  type: string
                  format: date
                  description: Single date (use one of date, startDate+endDate, or dates)
                startDate:
                  type: string
                  format: date
                  description: Range start (with endDate)
                endDate:
                  type: string
                  format: date
                  description: Range end (with startDate)
                dates:
                  type: array
                  items:
                    type: string
                    format: date
                  description: Multiple discrete dates
                status:
                  type: string
                  enum: [available, "not available"]
                  example: "available"
                note:
                  type: string
                  nullable: true
      responses:
        '200':
          description: Availability updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                  guideId:
                    type: string
                  updated:
                    type: integer
                  dateRanges:
                    type: array
                    items:
                      type: object
                      properties:
                        startDate:
                          type: string
                        endDate:
                          type: string
        '400':
          description: Validation error or invalid dates
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Guide not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /trails:
    get:
      tags:
        - Trail Management
      summary: Get all trails
      description: |
        Retrieve a list of all trails with optional filtering and pagination.
        Supports filtering by fid, id, name, difficulty, and search query.
      operationId: getAllTrails
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          example: 1
          description: Page number for pagination
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          example: 10
          description: Number of items per page
        - name: fid
          in: query
          schema:
            type: integer
          example: 123
          description: Filter by properties.fid
        - name: id
          in: query
          schema:
            type: integer
          example: 456
          description: Filter by properties.id
        - name: name
          in: query
          schema:
            type: string
          example: "Everest"
          description: Filter by trail name (case-insensitive partial match)
        - name: difficulty
          in: query
          schema:
            type: integer
          example: 3
          description: Filter by difficulty level
        - name: search
          in: query
          schema:
            type: string
          example: "base camp"
          description: Search in name and description (case-insensitive)
        - name: sortBy
          in: query
          schema:
            type: string
            enum: ["createdAt", "updatedAt", "properties.name", "properties.difficulty"]
            default: "createdAt"
          example: "createdAt"
          description: Field to sort by
        - name: sortOrder
          in: query
          schema:
            type: string
            enum: ["asc", "desc"]
            default: "desc"
          example: "desc"
          description: Sort order
      responses:
        '200':
          description: Trails retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  count:
                    type: integer
                    example: 10
                  total:
                    type: integer
                    example: 150
                  page:
                    type: integer
                    example: 1
                  pages:
                    type: integer
                    example: 15
                  trails:
                    type: array
                    items:
                      $ref: '#/components/schemas/Trail'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags:
        - Trail Management
      summary: Create a new trail
      description: Create a new trail with GeoJSON Feature format
      operationId: createTrail
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - geometry
              properties:
                type:
                  type: string
                  enum: ["Feature"]
                  default: "Feature"
                  example: "Feature"
                geometry:
                  $ref: '#/components/schemas/GeoJSONGeometry'
                properties:
                  type: object
                  description: Trail properties (fid, id, name, difficulty, etc.)
                  example:
                    fid: 123
                    id: 456
                    name: "Everest Base Camp Trail"
                    difficulty: 4
      responses:
        '201':
          description: Trail created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Trail created successfully"
                  trail:
                    $ref: '#/components/schemas/Trail'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /trails/{id}:
    get:
      tags:
        - Trail Management
      summary: Get trail by ID
      description: Retrieve a specific trail by its ID
      operationId: getTrailById
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
          example: "507f1f77bcf86cd799439011"
          description: MongoDB ObjectId of the trail
      responses:
        '200':
          description: Trail retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  trail:
                    $ref: '#/components/schemas/Trail'
        '400':
          description: Invalid trail ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Trail not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Trail Management
      summary: Update trail
      description: Update an existing trail's geometry or properties
      operationId: updateTrail
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
          example: "507f1f77bcf86cd799439011"
          description: MongoDB ObjectId of the trail
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                type:
                  type: string
                  enum: ["Feature"]
                  example: "Feature"
                geometry:
                  $ref: '#/components/schemas/GeoJSONGeometry'
                properties:
                  type: object
                  description: Trail properties
      responses:
        '200':
          description: Trail updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Trail updated successfully"
                  trail:
                    $ref: '#/components/schemas/Trail'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Trail not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Trail Management
      summary: Delete trail
      description: Delete a trail from the system
      operationId: deleteTrail
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
          example: "507f1f77bcf86cd799439011"
          description: MongoDB ObjectId of the trail
      responses:
        '200':
          description: Trail deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Trail deleted successfully"
        '400':
          description: Invalid trail ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Trail not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /trail-info:
    get:
      tags:
        - Trail Info Management
      summary: Get all trail info
      description: Retrieve a list of all trail information records
      operationId: getAllTrailInfo
      security:
        - bearerAuth: []
      parameters:
        - name: isFeatured
          in: query
          schema:
            type: boolean
          example: true
          description: Filter by featured status
      responses:
        '200':
          description: Trail info retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  count:
                    type: integer
                    example: 50
                  trailInfo:
                    type: array
                    items:
                      $ref: '#/components/schemas/TrailInfo'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags:
        - Trail Info Management
      summary: Create trail info
      description: |
        Create a new trail information record. Can optionally create a Trail automatically if geometry is provided.
        Supports both multipart/form-data (for image upload) and application/json.
      operationId: createTrailInfo
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - name
                - region
                - country
                - description
                - difficulty
                - duration_days
                - total_distance_km
                - best_season
                - major_highlights
                - starting_point
                - ending_point
                - altitude_min_m
                - altitude_max_m
              properties:
                name:
                  type: string
                  example: "Everest Base Camp Trek"
                region:
                  type: string
                  example: "Khumbu"
                country:
                  type: string
                  example: "Nepal"
                description:
                  type: string
                  example: "A challenging trek to the base of the world's highest mountain"
                difficulty:
                  type: string
                  example: "Hard"
                duration_days:
                  type: integer
                  example: 14
                total_distance_km:
                  type: number
                  example: 130
                best_season:
                  type: string
                  format: json
                  example: '["Spring", "Autumn"]'
                  description: JSON string array
                major_highlights:
                  type: string
                  format: json
                  example: '["Mount Everest", "Kala Patthar", "Namche Bazaar"]'
                  description: JSON string array
                starting_point:
                  type: string
                  format: json
                  example: '{"name": "Lukla", "altitude_m": 2840}'
                  description: JSON string object
                ending_point:
                  type: string
                  format: json
                  example: '{"name": "Everest Base Camp", "altitude_m": 5364}'
                  description: JSON string object
                altitude_min_m:
                  type: number
                  example: 2840
                altitude_max_m:
                  type: number
                  example: 5545
                permit_required:
                  type: string
                  format: json
                  example: '["Sagarmatha National Park Permit", "TIMS Card"]'
                  description: JSON string array (optional)
                environment:
                  type: string
                  format: json
                  example: '{"wildlife": ["Snow Leopard", "Himalayan Tahr"], "local_culture": "Sherpa culture", "climate_conditions": "Cold and dry", "conservation_rules": "Leave no trace"}'
                  description: JSON string object (optional)
                user_content:
                  type: string
                  format: json
                  example: '{"rating_avg": 4.5, "rating_count": 120}'
                  description: JSON string object (optional)
                location:
                  type: string
                  example: "Khumbu Region, Nepal"
                time:
                  type: string
                  example: "14 days"
                activityType:
                  type: string
                  enum: ["Hike", "Trekking", "City Tour"]
                  example: "Trekking"
                isFeatured:
                  type: boolean
                  example: true
                trailId:
                  type: string
                  example: "507f1f77bcf86cd799439011"
                  description: Optional existing trail ID
                geometry:
                  type: string
                  format: json
                  example: '{"type": "LineString", "coordinates": [[86.712, 27.802], [86.715, 27.805]]}'
                  description: Optional GeoJSON geometry to create Trail automatically
                trailProperties:
                  type: string
                  format: json
                  example: '{"fid": 123, "id": 456, "name": "Everest Base Camp Trail", "difficulty": 4}'
                  description: Optional trail properties for auto-created Trail
                image:
                  type: string
                  format: binary
                  description: Image file (alternative to imageUrl)
                imageUrl:
                  type: string
                  example: "https://example.com/image.jpg"
                  description: Image URL (alternative to image file)
          application/json:
            schema:
              type: object
              required:
                - name
                - region
                - country
                - description
                - difficulty
                - duration_days
                - total_distance_km
                - best_season
                - major_highlights
                - starting_point
                - ending_point
                - altitude_min_m
                - altitude_max_m
                - imageUrl
              properties:
                name:
                  type: string
                  example: "Everest Base Camp Trek"
                region:
                  type: string
                  example: "Khumbu"
                country:
                  type: string
                  example: "Nepal"
                description:
                  type: string
                  example: "A challenging trek to the base of the world's highest mountain"
                difficulty:
                  type: string
                  example: "Hard"
                duration_days:
                  type: integer
                  example: 14
                total_distance_km:
                  type: number
                  example: 130
                best_season:
                  type: array
                  items:
                    type: string
                  example: ["Spring", "Autumn"]
                major_highlights:
                  type: array
                  items:
                    type: string
                  example: ["Mount Everest", "Kala Patthar", "Namche Bazaar"]
                starting_point:
                  $ref: '#/components/schemas/Point'
                ending_point:
                  $ref: '#/components/schemas/Point'
                altitude_min_m:
                  type: number
                  example: 2840
                altitude_max_m:
                  type: number
                  example: 5545
                permit_required:
                  type: array
                  items:
                    type: string
                  example: ["Sagarmatha National Park Permit", "TIMS Card"]
                environment:
                  $ref: '#/components/schemas/Environment'
                user_content:
                  $ref: '#/components/schemas/UserContent'
                location:
                  type: string
                  example: "Khumbu Region, Nepal"
                time:
                  type: string
                  example: "14 days"
                activityType:
                  type: string
                  enum: ["Hike", "Trekking", "City Tour"]
                  example: "Trekking"
                isFeatured:
                  type: boolean
                  example: true
                trailId:
                  type: string
                  pattern: '^[0-9a-fA-F]{24}$'
                  example: "507f1f77bcf86cd799439011"
                  description: Optional existing trail ID
                geometry:
                  $ref: '#/components/schemas/GeoJSONGeometry'
                  description: Optional GeoJSON geometry to create Trail automatically
                trailProperties:
                  type: object
                  description: Optional trail properties for auto-created Trail
                  example:
                    fid: 123
                    id: 456
                    name: "Everest Base Camp Trail"
                    difficulty: 4
                imageUrl:
                  type: string
                  format: uri
                  example: "https://example.com/image.jpg"
      responses:
        '201':
          description: Trail info created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Trail info created successfully"
                  trailInfo:
                    $ref: '#/components/schemas/TrailInfo'
                  trail:
                    type: object
                    nullable: true
                    description: Trail object if created automatically
                    properties:
                      _id:
                        type: string
                      type:
                        type: string
                      geometry:
                        $ref: '#/components/schemas/GeoJSONGeometry'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /trail-info/featured:
    get:
      tags:
        - Trail Info Management
      summary: Get featured trails
      description: Retrieve a simplified list of featured trails
      operationId: getFeaturedTrails
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Featured trails retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  count:
                    type: integer
                    example: 10
                  trails:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          example: "507f1f77bcf86cd799439011"
                        name:
                          type: string
                          example: "Everest Base Camp Trek"
                        region:
                          type: string
                          example: "Khumbu"
                        country:
                          type: string
                          example: "Nepal"
                        difficulty:
                          type: string
                          example: "Hard"
                        duration_days:
                          type: integer
                          example: 14
                        activityType:
                          type: string
                          example: "Trekking"
                        image:
                          type: string
                          format: uri
                          example: "https://cloudinary.com/image.jpg"
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /trail-info/{id}:
    get:
      tags:
        - Trail Info Management
      summary: Get trail info by ID
      description: Retrieve a specific trail information record by its ID
      operationId: getTrailInfoById
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
          example: "507f1f77bcf86cd799439011"
          description: MongoDB ObjectId of the trail info
      responses:
        '200':
          description: Trail info retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  trailInfo:
                    $ref: '#/components/schemas/TrailInfo'
        '400':
          description: Invalid trail info ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Trail info not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Trail Info Management
      summary: Update trail info
      description: |
        Update an existing trail information record.
        Supports both multipart/form-data (for image upload) and application/json.
      operationId: updateTrailInfo
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
          example: "507f1f77bcf86cd799439011"
          description: MongoDB ObjectId of the trail info
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                name:
                  type: string
                region:
                  type: string
                country:
                  type: string
                description:
                  type: string
                difficulty:
                  type: string
                duration_days:
                  type: integer
                total_distance_km:
                  type: number
                best_season:
                  type: string
                  format: json
                major_highlights:
                  type: string
                  format: json
                starting_point:
                  type: string
                  format: json
                ending_point:
                  type: string
                  format: json
                altitude_min_m:
                  type: number
                altitude_max_m:
                  type: number
                permit_required:
                  type: string
                  format: json
                environment:
                  type: string
                  format: json
                user_content:
                  type: string
                  format: json
                location:
                  type: string
                time:
                  type: string
                activityType:
                  type: string
                  enum: ["Hike", "Trekking", "City Tour"]
                isFeatured:
                  type: boolean
                trailId:
                  type: string
                image:
                  type: string
                  format: binary
                imageUrl:
                  type: string
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                region:
                  type: string
                country:
                  type: string
                description:
                  type: string
                difficulty:
                  type: string
                duration_days:
                  type: integer
                total_distance_km:
                  type: number
                best_season:
                  type: array
                  items:
                    type: string
                major_highlights:
                  type: array
                  items:
                    type: string
                starting_point:
                  $ref: '#/components/schemas/Point'
                ending_point:
                  $ref: '#/components/schemas/Point'
                altitude_min_m:
                  type: number
                altitude_max_m:
                  type: number
                permit_required:
                  type: array
                  items:
                    type: string
                environment:
                  $ref: '#/components/schemas/Environment'
                user_content:
                  $ref: '#/components/schemas/UserContent'
                location:
                  type: string
                time:
                  type: string
                activityType:
                  type: string
                  enum: ["Hike", "Trekking", "City Tour"]
                isFeatured:
                  type: boolean
                trailId:
                  type: string
                  pattern: '^[0-9a-fA-F]{24}$'
                imageUrl:
                  type: string
                  format: uri
      responses:
        '200':
          description: Trail info updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Trail info updated successfully"
                  trailInfo:
                    $ref: '#/components/schemas/TrailInfo'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Trail info not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Trail Info Management
      summary: Delete trail info
      description: Delete a trail information record and its associated image from Cloudinary
      operationId: deleteTrailInfo
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
          example: "507f1f77bcf86cd799439011"
          description: MongoDB ObjectId of the trail info
      responses:
        '200':
          description: Trail info deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Trail info deleted successfully"
        '400':
          description: Invalid trail info ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Trail info not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /stats/dashboard:
    get:
      tags:
        - Statistics
      summary: Get dashboard statistics
      description: Retrieve comprehensive dashboard statistics including user counts, guide counts, trail counts, and various breakdowns
      operationId: getDashboardStats
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Statistics retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  stats:
                    $ref: '#/components/schemas/DashboardStats'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token obtained from /auth/login endpoint

  schemas:
    AdminProfile:
      type: object
      properties:
        id:
          type: string
          example: "507f1f77bcf86cd799439011"
        firstName:
          type: string
          example: "Admin"
        lastName:
          type: string
          example: "User"
        email:
          type: string
          format: email
          example: "admin@yatrax.com"
        role:
          type: string
          enum: ["admin"]
          example: "admin"
        type:
          type: string
          enum: ["user", "guide"]
          example: "user"
          description: Model type (user or guide)
        subscription:
          type: string
          enum: ["free", "premium"]
          example: "premium"
          description: Only present if type is "user"
        country:
          type: string
          example: "Nepal"
          description: Only present if type is "user"
        description:
          type: string
          example: "Experienced guide"
          description: Only present if type is "guide"
        TBNumber:
          type: string
          example: "TB-12345"
          description: Only present if type is "guide"

    User:
      type: object
      properties:
        _id:
          type: string
          example: "507f1f77bcf86cd799439011"
        firstName:
          type: string
          example: "John"
        lastName:
          type: string
          example: "Doe"
        email:
          type: string
          format: email
          example: "user@example.com"
        country:
          type: string
          example: "Nepal"
        role:
          type: string
          enum: ["user", "porter", "admin"]
          example: "user"
        subscription:
          type: string
          enum: ["free", "premium"]
          example: "free"
        authProvider:
          type: string
          enum: ["local", "google"]
          example: "local"
        createdAt:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00.000Z"
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00.000Z"

    UserBasic:
      type: object
      properties:
        id:
          type: string
          example: "507f1f77bcf86cd799439011"
        firstName:
          type: string
          example: "John"
        lastName:
          type: string
          example: "Doe"
        email:
          type: string
          format: email
          example: "user@example.com"
        country:
          type: string
          example: "Nepal"
        role:
          type: string
          enum: ["user", "porter", "admin"]
          example: "user"
        subscription:
          type: string
          enum: ["free", "premium"]
          example: "free"

    Guide:
      type: object
      properties:
        _id:
          type: string
          example: "507f1f77bcf86cd799439011"
        firstName:
          type: string
          example: "Ram"
        lastName:
          type: string
          example: "Shrestha"
        email:
          type: string
          format: email
          example: "guide@example.com"
        role:
          type: string
          enum: ["guide", "admin"]
          example: "guide"
        description:
          type: string
          example: "Experienced trekking guide with 10 years of experience"
        TBNumber:
          type: string
          example: "TB-12345"
        trekAreas:
          type: array
          items:
            type: string
          example: ["Everest Base Camp", "Annapurna Circuit", "Langtang"]
        experience:
          type: integer
          example: 10
        education:
          type: string
          example: "Bachelor's in Tourism"
        languages:
          type: array
          items:
            type: string
          example: ["English", "Nepali", "Hindi"]
        ratePerDay:
          type: number
          example: 50
        certifications:
          type: array
          items:
            type: string
          example: ["Wilderness First Aid", "Mountain Guide Certification"]
        photo:
          type: string
          format: uri
          nullable: true
          example: "https://cloudinary.com/photo.jpg"
        createdAt:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00.000Z"
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00.000Z"

    GuideBasic:
      type: object
      properties:
        id:
          type: string
          example: "507f1f77bcf86cd799439011"
        firstName:
          type: string
          example: "Ram"
        lastName:
          type: string
          example: "Shrestha"
        email:
          type: string
          format: email
          example: "guide@example.com"
        role:
          type: string
          enum: ["guide", "admin"]
          example: "guide"
        description:
          type: string
          example: "Experienced trekking guide"
        TBNumber:
          type: string
          example: "TB-12345"
        trekAreas:
          type: array
          items:
            type: string
        experience:
          type: integer
        education:
          type: string
        languages:
          type: array
          items:
            type: string
        ratePerDay:
          type: number
        certifications:
          type: array
          items:
            type: string

    Trail:
      type: object
      properties:
        _id:
          type: string
          example: "507f1f77bcf86cd799439011"
        type:
          type: string
          enum: ["Feature"]
          example: "Feature"
        geometry:
          $ref: '#/components/schemas/GeoJSONGeometry'
        properties:
          type: object
          description: Trail properties (fid, id, name, difficulty, trailInfoId, activityType, etc.)
          example:
            fid: 123
            id: 456
            name: "Everest Base Camp Trail"
            difficulty: 4
            trailInfoId: "507f1f77bcf86cd799439012"
            activityType: "Trekking"
        trailInfo:
          $ref: '#/components/schemas/TrailInfo'
          description: Populated trail info if available
        createdAt:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00.000Z"
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00.000Z"

    GeoJSONGeometry:
      type: object
      required:
        - type
        - coordinates
      properties:
        type:
          type: string
          enum: ["Point", "LineString", "Polygon", "MultiPoint", "MultiLineString", "MultiPolygon"]
          example: "LineString"
        coordinates:
          oneOf:
            - type: array
              items:
                type: number
              minItems: 2
              maxItems: 2
              description: Point coordinates [longitude, latitude]
              example: [86.712, 27.802]
            - type: array
              items:
                type: array
                items:
                  type: number
              description: LineString or MultiPoint coordinates
              example: [[86.712, 27.802], [86.715, 27.805]]
            - type: array
              items:
                type: array
                items:
                  type: array
                  items:
                    type: number
              description: Polygon or MultiLineString coordinates
              example: [[[86.712, 27.802], [86.715, 27.805], [86.718, 27.808], [86.712, 27.802]]]
            - type: array
              items:
                type: array
                items:
                  type: array
                  items:
                    type: array
                    items:
                      type: number
              description: MultiPolygon coordinates

    TrailInfo:
      type: object
      properties:
        _id:
          type: string
          example: "507f1f77bcf86cd799439011"
        name:
          type: string
          example: "Everest Base Camp Trek"
        region:
          type: string
          example: "Khumbu"
        country:
          type: string
          example: "Nepal"
        description:
          type: string
          example: "A challenging trek to the base of the world's highest mountain"
        difficulty:
          type: string
          example: "Hard"
        duration_days:
          type: integer
          example: 14
        total_distance_km:
          type: number
          example: 130
        best_season:
          type: array
          items:
            type: string
          example: ["Spring", "Autumn"]
        major_highlights:
          type: array
          items:
            type: string
          example: ["Mount Everest", "Kala Patthar", "Namche Bazaar"]
        starting_point:
          $ref: '#/components/schemas/Point'
        ending_point:
          $ref: '#/components/schemas/Point'
        altitude_min_m:
          type: number
          example: 2840
        altitude_max_m:
          type: number
          example: 5545
        permit_required:
          type: array
          items:
            type: string
          example: ["Sagarmatha National Park Permit", "TIMS Card"]
        environment:
          $ref: '#/components/schemas/Environment'
        user_content:
          $ref: '#/components/schemas/UserContent'
        image:
          type: string
          format: uri
          example: "https://cloudinary.com/image.jpg"
        location:
          type: string
          example: "Khumbu Region, Nepal"
        time:
          type: string
          example: "14 days"
        activityType:
          type: string
          enum: ["Hike", "Trekking", "City Tour"]
          example: "Trekking"
        isFeatured:
          type: boolean
          example: true
        trailId:
          type: string
          nullable: true
          example: "507f1f77bcf86cd799439011"
        createdAt:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00.000Z"
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00.000Z"

    Point:
      type: object
      required:
        - name
        - altitude_m
      properties:
        name:
          type: string
          example: "Lukla"
        altitude_m:
          type: number
          example: 2840

    Environment:
      type: object
      properties:
        wildlife:
          type: array
          items:
            type: string
          example: ["Snow Leopard", "Himalayan Tahr"]
        local_culture:
          type: string
          example: "Sherpa culture"
        climate_conditions:
          type: string
          example: "Cold and dry"
        conservation_rules:
          type: string
          example: "Leave no trace"

    UserContent:
      type: object
      properties:
        rating_avg:
          type: number
          minimum: 0
          maximum: 5
          example: 4.5
        rating_count:
          type: integer
          minimum: 0
          example: 120

    DashboardStats:
      type: object
      properties:
        overview:
          type: object
          properties:
            totalUsers:
              type: integer
              example: 1500
            totalGuides:
              type: integer
              example: 200
            totalTrails:
              type: integer
              example: 150
            activeUsers:
              type: integer
              example: 500
              description: Users with premium subscription
            activeGuides:
              type: integer
              example: 180
              description: Guides with role "guide"
            activeTrails:
              type: integer
              example: 140
              description: "Trails with isActive: true"
        recentActivity:
          type: object
          properties:
            recentUsers:
              type: integer
              example: 50
            recentGuides:
              type: integer
              example: 10
            recentTrails:
              type: integer
              example: 5
            period:
              type: string
              example: "last 30 days"
        breakdowns:
          type: object
          properties:
            usersByRole:
              type: object
              additionalProperties:
                type: integer
              example:
                user: 1200
                porter: 200
                admin: 100
            usersBySubscription:
              type: object
              additionalProperties:
                type: integer
              example:
                free: 1000
                premium: 500
            trailsByDifficulty:
              type: object
              additionalProperties:
                type: integer
              example:
                "1": 20
                "2": 30
                "3": 40
                "4": 35
                "5": 25
            guidesByExperience:
              type: array
              items:
                type: object
                properties:
                  _id:
                    type: object
                    properties:
                      min:
                        type: number
                      max:
                        type: number
                    description: Experience range
                  count:
                    type: integer
              example:
                - _id: { min: 0, max: 1 }
                  count: 20
                - _id: { min: 1, max: 3 }
                  count: 50
                - _id: { min: 3, max: 5 }
                  count: 60
                - _id: { min: 5, max: 10 }
                  count: 40
                - _id: { min: 10, max: 20 }
                  count: 20
                - _id: "20+"
                  count: 10

    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        message:
          type: string
          example: "Error message"
        error:
          type: string
          example: "Detailed error message"
          description: Optional detailed error information
